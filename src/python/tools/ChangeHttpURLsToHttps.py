# Converts all valid HTTP links to HTTPS, where the fed
# HTTP links are found in Report_AlterableUrls_FindHttpURLs.csv, which
# is generated by FindHttpURLs.py
# usage: python3 ChangeHttpURLsToHttps.py [path to Report_FindHttpURLs.txt]
# output: Report_ReplaceHttpsURLs.txt

import sys
import os
import csv

def changeUrl(pathToUrl, url):
     fullText = open(pathToUrl).read()
     fullText = fullText.replace(url, url.replace('http', 'https'))
     f = open(pathToUrl, 'w')
     f.write(fullText)
     f.close()

def changeUrls(pathToReportCsv):
    with open(pathToReportCsv, newline='') as csvFile:
        csv_reader = csv.reader(csvFile, delimiter=',')
        line_count = 0
        for row in csv_reader:
            if line_count == 0:
                line_count += 1
            else:
                print(row)
                changeUrl(row[0], row[1])
                line_count += 1
        print(f'Processed {line_count} URLs.')

def main():
    if len(sys.argv) < 2:
        print("Usage: python3 ChangeHttpURLsToHttps.py [PATH_TO_Report_AlterableUrls_FindHttpURLs.csv]")
        exit(1)
    changeUrls(sys.argv[1])


if __name__ == "__main__":
    main()